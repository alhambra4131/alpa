const a97_0x2045=['MAX_SAFE_INTEGER','client','length','default','../utils/gamification','splice','save','experience','tesseract','replace','content','language','handleGamification','humanMessage','set','handleVotingChannels','find','handleLevelRoles','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','Constants','gamification','exports','multiplier','enabled','push','level','filter','levelUp','has','getString','exec','channel','handleTriggers','get','send','info','_id','responseMessage','IRIS','setTimeout','Logger','cache','balance','DEFAUL_CURRENCY_REWARD_MULTIPLIER','parseEmoji','add','responseReaction','findOne','includes','../models/Trigger','author','roles','recentUsers','ModuleManagerEvent','member','constructor','document','LEVELED\x20UP!','../models/Role','guild','react','return\x20/\x22\x20+\x20this\x20+\x20\x22/','../models/TextChannel','messages','catch','reaction','MAX_LEVEL','../utils/emojis','COLORS','apply'];(function(_0x431e3c,_0x20459e){const _0x390557=function(_0x2ad9a3){while(--_0x2ad9a3){_0x431e3c['push'](_0x431e3c['shift']());}};const _0x373339=function(){const _0x4fc085={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x4aca4f,_0xd4108a,_0x47f83b,_0x36d57d){_0x36d57d=_0x36d57d||{};let _0x41b456=_0xd4108a+'='+_0x47f83b;let _0x5d8367=0x0;for(let _0x27ed74=0x0,_0x3719ac=_0x4aca4f['length'];_0x27ed74<_0x3719ac;_0x27ed74++){const _0x29ed0d=_0x4aca4f[_0x27ed74];_0x41b456+=';\x20'+_0x29ed0d;const _0x2a173f=_0x4aca4f[_0x29ed0d];_0x4aca4f['push'](_0x2a173f);_0x3719ac=_0x4aca4f['length'];if(_0x2a173f!==!![]){_0x41b456+='='+_0x2a173f;}}_0x36d57d['cookie']=_0x41b456;},'removeCookie':function(){return'dev';},'getCookie':function(_0x303295,_0xbf8d2e){_0x303295=_0x303295||function(_0x58ad74){return _0x58ad74;};const _0x2849bc=_0x303295(new RegExp('(?:^|;\x20)'+_0xbf8d2e['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x24d853=function(_0x329956,_0x5cd7a3){_0x329956(++_0x5cd7a3);};_0x24d853(_0x390557,_0x20459e);return _0x2849bc?decodeURIComponent(_0x2849bc[0x1]):undefined;}};const _0x8512a1=function(){const _0x333c9e=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x333c9e['test'](_0x4fc085['removeCookie']['toString']());};_0x4fc085['updateCookie']=_0x8512a1;let _0x2d9ef6='';const _0x26be64=_0x4fc085['updateCookie']();if(!_0x26be64){_0x4fc085['setCookie'](['*'],'counter',0x1);}else if(_0x26be64){_0x2d9ef6=_0x4fc085['getCookie'](null,'counter');}else{_0x4fc085['removeCookie']();}};_0x373339();}(a97_0x2045,0x17e));const a97_0x3905=function(_0x431e3c,_0x20459e){_0x431e3c=_0x431e3c-0x0;let _0x390557=a97_0x2045[_0x431e3c];return _0x390557;};const a97_0x4fc085=function(){let _0x4b0197=!![];return function(_0x9bd110,_0x34304b){const _0x21448a=_0x4b0197?function(){if(_0x34304b){const _0x10808a=_0x34304b[a97_0x3905('0x25')](_0x9bd110,arguments);_0x34304b=null;return _0x10808a;}}:function(){};_0x4b0197=![];return _0x21448a;};}();const a97_0x2ad9a3=a97_0x4fc085(this,function(){const _0xdc037a=function(){const _0x5ec144=_0xdc037a[a97_0x3905('0x17')](a97_0x3905('0x1d'))()['compile'](a97_0x3905('0x38'));return!_0x5ec144['test'](a97_0x2ad9a3);};return _0xdc037a();});a97_0x2ad9a3();'use strict';const tesseract_1=require(a97_0x3905('0x2e'));const emojis=require(a97_0x3905('0x23'));const numbers=require('../utils/numbers');const gamification=require(a97_0x3905('0x2a'));const Role_1=require(a97_0x3905('0x1a'));const TextChannel_1=require(a97_0x3905('0x1e'));const Trigger_1=require(a97_0x3905('0x11'));module[a97_0x3905('0x3b')]=class HumanMessageEvent extends tesseract_1[a97_0x3905('0x15')]{constructor(){super(a97_0x3905('0x33'));this[a97_0x3905('0x37')]=async(_0xf33451,_0x37672b)=>{const _0x42c5a7=await Role_1['default'][a97_0x3905('0x36')]({'guild':_0xf33451['guild']['id'],'level':_0x37672b});const _0x3483a4=_0x42c5a7[a97_0x3905('0x40')](_0x3db27f=>_0xf33451[a97_0x3905('0x1b')][a97_0x3905('0x13')][a97_0x3905('0x9')][a97_0x3905('0x42')](_0x3db27f[a97_0x3905('0x4')]));if(_0x3483a4[a97_0x3905('0x28')]){await _0xf33451[a97_0x3905('0x16')][a97_0x3905('0x13')][a97_0x3905('0xd')](_0x3483a4['map'](_0x1bc814=>_0x1bc814[a97_0x3905('0x4')]));}};this[a97_0x3905('0x32')]=async _0x10be03=>{const _0x330391=this['recentUsers'][a97_0x3905('0x1')](_0x10be03['guild']['id'])||[];if(_0x330391[a97_0x3905('0x10')](_0x10be03[a97_0x3905('0x12')]['id']))return;const _0x12c04f=_0x10be03[a97_0x3905('0x27')];const _0x47eced=_0x10be03[a97_0x3905('0x1b')];const _0x5e5521=_0x10be03[a97_0x3905('0x16')];if(!_0x47eced['document'][a97_0x3905('0x3a')]||!_0x47eced[a97_0x3905('0x18')]['gamification'][a97_0x3905('0x3d')])return;if(_0x5e5521['document'][a97_0x3905('0x3f')]>=gamification[a97_0x3905('0x22')]||_0x5e5521['document'][a97_0x3905('0x2d')]>=gamification['MAX_EXPERIENCE'](_0x47eced['document'][a97_0x3905('0x3a')][a97_0x3905('0x3c')]))return;_0x5e5521[a97_0x3905('0x18')][a97_0x3905('0x2d')]+=0x1;const _0x357165=gamification['computeLevel'](_0x5e5521['document'][a97_0x3905('0x2d')],_0x47eced[a97_0x3905('0x18')]['gamification'][a97_0x3905('0x3c')]);_0x5e5521['document'][a97_0x3905('0x3f')]=_0x357165;if(_0x357165>_0x5e5521[a97_0x3905('0x18')][a97_0x3905('0x3f')]){_0x5e5521[a97_0x3905('0x18')][a97_0x3905('0xa')]=numbers['clamp'](_0x5e5521['document'][a97_0x3905('0xa')]+_0x357165*gamification[a97_0x3905('0xb')],Number[a97_0x3905('0x26')]);if(_0x47eced[a97_0x3905('0x18')][a97_0x3905('0x3a')][a97_0x3905('0x1f')]){_0x10be03[a97_0x3905('0x45')][a97_0x3905('0x2')]({'embed':{'color':tesseract_1[a97_0x3905('0x39')][a97_0x3905('0x24')][a97_0x3905('0x6')],'fields':[{'name':a97_0x3905('0x19'),'value':_0x12c04f['locale'][a97_0x3905('0x43')](_0x47eced[a97_0x3905('0x18')][a97_0x3905('0x31')],a97_0x3905('0x3'),a97_0x3905('0x41'),_0x10be03[a97_0x3905('0x12')]['tag'],_0x5e5521[a97_0x3905('0x18')][a97_0x3905('0x3f')])}]}})['catch'](()=>{});}this[a97_0x3905('0x37')](_0x10be03,_0x5e5521[a97_0x3905('0x18')][a97_0x3905('0x3f')])[a97_0x3905('0x20')](tesseract_1[a97_0x3905('0x8')]['error']);}await _0x5e5521['document'][a97_0x3905('0x2c')]();_0x330391[a97_0x3905('0x3e')](_0x10be03['author']['id']);this[a97_0x3905('0x14')][a97_0x3905('0x34')](_0x10be03[a97_0x3905('0x1b')]['id'],_0x330391);_0x10be03[a97_0x3905('0x27')][a97_0x3905('0x7')](()=>{const _0x613bef=this[a97_0x3905('0x14')][a97_0x3905('0x1')](_0x10be03['guild']['id']);_0x613bef[a97_0x3905('0x2b')](_0x613bef['indexOf'](_0x10be03[a97_0x3905('0x12')]['id']),0x1);this[a97_0x3905('0x14')][a97_0x3905('0x34')](_0x10be03[a97_0x3905('0x1b')]['id'],_0x613bef);},0x32c8);};this['handleTriggers']=async _0x427807=>{if(!_0x427807[a97_0x3905('0x30')])return;const _0xc18ad6=await Trigger_1['default'][a97_0x3905('0x36')]({'guild':_0x427807['guild']['id']});for(const _0x107792 of _0xc18ad6){const _0x135141=new RegExp(_0x107792['trigger'][a97_0x3905('0x2f')](/\?/g,'.')[a97_0x3905('0x2f')](/\*+/g,'.*'),'ig');if(!_0x135141['test'](_0x427807['content']))continue;if(_0x107792[a97_0x3905('0x5')]){_0x427807['channel']['send'](_0x107792['responseMessage']);}if(_0x107792[a97_0x3905('0xe')]){const _0x534ced=emojis[a97_0x3905('0xc')](_0x107792[a97_0x3905('0xe')]);if(_0x534ced){_0x427807[a97_0x3905('0x1c')](_0x534ced[a97_0x3905('0x21')]);}}}};this[a97_0x3905('0x35')]=async _0x3fab0f=>{const _0x55074d=await TextChannel_1[a97_0x3905('0x29')][a97_0x3905('0xf')]({'_id':_0x3fab0f[a97_0x3905('0x45')]['id'],'voting':!![]});if(!_0x55074d)return;_0x3fab0f[a97_0x3905('0x1c')]('ðŸ‘')[a97_0x3905('0x20')](()=>{});_0x3fab0f[a97_0x3905('0x1c')]('ðŸ‘Ž')[a97_0x3905('0x20')](()=>{});};this[a97_0x3905('0x44')]=async _0x2c90ed=>{if(!_0x2c90ed[a97_0x3905('0x1b')])return;this[a97_0x3905('0x32')](_0x2c90ed)['catch'](()=>{});this[a97_0x3905('0x0')](_0x2c90ed)[a97_0x3905('0x20')](()=>{});this[a97_0x3905('0x35')](_0x2c90ed)[a97_0x3905('0x20')](()=>{});};this[a97_0x3905('0x14')]=new Map();}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh1bWFuTWVzc2FnZS5qcyJdLCJuYW1lcyI6WyJ0ZXNzZXJhY3RfMSIsInJlcXVpcmUiLCJlbW9qaXMiLCJudW1iZXJzIiwiZ2FtaWZpY2F0aW9uIiwiUm9sZV8xIiwiVGV4dENoYW5uZWxfMSIsIlRyaWdnZXJfMSIsIm1vZHVsZSIsIkh1bWFuTWVzc2FnZUV2ZW50IiwiY29uc3RydWN0b3IiLCJfMHhmMzM0NTEiLCJfMHgzNzY3MmIiLCJfMHg0MmM1YTciLCJfMHgzNDgzYTQiLCJfMHgzZGIyN2YiLCJfMHgxYmM4MTQiLCJfMHgxMGJlMDMiLCJfMHgzMzAzOTEiLCJfMHgxMmMwNGYiLCJfMHg0N2VjZWQiLCJfMHg1ZTU1MjEiLCJfMHgzNTcxNjUiLCJOdW1iZXIiLCJfMHg2MTNiZWYiLCJfMHg0Mjc4MDciLCJfMHhjMThhZDYiLCJfMHgxMDc3OTIiLCJfMHgxMzUxNDEiLCJSZWdFeHAiLCJfMHg1MzRjZWQiLCJfMHgzZmFiMGYiLCJfMHg1NTA3NGQiLCJfMHgyYzkwZWQiLCJNYXAiXSwibWFwcGluZ3MiOiJ1bkdBQUEsYUFLQSxNQUFNQSxXQUFBLENBQWNDLE9BQUEsQyxrQkFBQSxDQUFwQixDQUNBLE1BQU1DLE1BQUEsQ0FBU0QsT0FBQSxDLGtCQUFBLENBQWYsQ0FDQSxNQUFNRSxPQUFBLENBQVVGLE9BQUEsQyxrQkFBQSxDQUFoQixDQUNBLE1BQU1HLFlBQUEsQ0FBZUgsT0FBQSxDLGtCQUFBLENBQXJCLENBQ0EsTUFBTUksTUFBQSxDQUFTSixPQUFBLEMsa0JBQUEsQ0FBZixDQUNBLE1BQU1LLGFBQUEsQ0FBZ0JMLE9BQUEsQyxrQkFBQSxDQUF0QixDQUNBLE1BQU1NLFNBQUEsQ0FBWU4sT0FBQSxDLGtCQUFBLENBQWxCLENBQ0FPLE1BQUEsQyxrQkFBQSxFQUFpQixNQUFNQyxpQkFBTixTQUFnQ1QsV0FBQSxDLGtCQUFBLENBQStCLENBQzVFVSxXQUFBLEVBQWMsQ0FDVixNLGtCQUFBLEVBQ0EsSyxrQkFBQSxFQUF3QixNQUFPQyxTQUFQLENBQWdC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RCxDQUFoRiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuLyohXG4gKiBAYXV0aG9yIFNhbmthcnNhbiBLYW1wYSAoazNybjMxcDRuaWMpXG4gKiBAY29weXJpZ2h0IDIwMjAgLSBUaGUgQmFzdGlvbiBCb3QgUHJvamVjdFxuICovXG5jb25zdCB0ZXNzZXJhY3RfMSA9IHJlcXVpcmUoXCJ0ZXNzZXJhY3RcIik7XG5jb25zdCBlbW9qaXMgPSByZXF1aXJlKFwiLi4vdXRpbHMvZW1vamlzXCIpO1xuY29uc3QgbnVtYmVycyA9IHJlcXVpcmUoXCIuLi91dGlscy9udW1iZXJzXCIpO1xuY29uc3QgZ2FtaWZpY2F0aW9uID0gcmVxdWlyZShcIi4uL3V0aWxzL2dhbWlmaWNhdGlvblwiKTtcbmNvbnN0IFJvbGVfMSA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvUm9sZVwiKTtcbmNvbnN0IFRleHRDaGFubmVsXzEgPSByZXF1aXJlKFwiLi4vbW9kZWxzL1RleHRDaGFubmVsXCIpO1xuY29uc3QgVHJpZ2dlcl8xID0gcmVxdWlyZShcIi4uL21vZGVscy9UcmlnZ2VyXCIpO1xubW9kdWxlLmV4cG9ydHMgPSBjbGFzcyBIdW1hbk1lc3NhZ2VFdmVudCBleHRlbmRzIHRlc3NlcmFjdF8xLk1vZHVsZU1hbmFnZXJFdmVudCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwiaHVtYW5NZXNzYWdlXCIpO1xuICAgICAgICB0aGlzLmhhbmRsZUxldmVsUm9sZXMgPSBhc3luYyAobWVzc2FnZSwgbGV2ZWwpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJvbGVzID0gYXdhaXQgUm9sZV8xLmRlZmF1bHQuZmluZCh7XG4gICAgICAgICAgICAgICAgZ3VpbGQ6IG1lc3NhZ2UuZ3VpbGQuaWQsXG4gICAgICAgICAgICAgICAgbGV2ZWw6IGxldmVsLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBsZXZlbFJvbGVzID0gcm9sZXMuZmlsdGVyKHIgPT4gbWVzc2FnZS5ndWlsZC5yb2xlcy5jYWNoZS5oYXMoci5faWQpKTtcbiAgICAgICAgICAgIGlmIChsZXZlbFJvbGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IG1lc3NhZ2UubWVtYmVyLnJvbGVzLmFkZChsZXZlbFJvbGVzLm1hcChyID0+IHIuX2lkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlR2FtaWZpY2F0aW9uID0gYXN5bmMgKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY2VudFVzZXJzID0gdGhpcy5yZWNlbnRVc2Vycy5nZXQobWVzc2FnZS5ndWlsZC5pZCkgfHwgW107XG4gICAgICAgICAgICBpZiAocmVjZW50VXNlcnMuaW5jbHVkZXMobWVzc2FnZS5hdXRob3IuaWQpKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IGJhc3Rpb24gPSBtZXNzYWdlLmNsaWVudDtcbiAgICAgICAgICAgIGNvbnN0IGd1aWxkID0gbWVzc2FnZS5ndWlsZDtcbiAgICAgICAgICAgIGNvbnN0IG1lbWJlciA9IG1lc3NhZ2UubWVtYmVyO1xuICAgICAgICAgICAgaWYgKCFndWlsZC5kb2N1bWVudC5nYW1pZmljYXRpb24gfHwgIWd1aWxkLmRvY3VtZW50LmdhbWlmaWNhdGlvbi5lbmFibGVkKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGlmIChtZW1iZXIuZG9jdW1lbnQubGV2ZWwgPj0gZ2FtaWZpY2F0aW9uLk1BWF9MRVZFTCB8fCBtZW1iZXIuZG9jdW1lbnQuZXhwZXJpZW5jZSA+PSBnYW1pZmljYXRpb24uTUFYX0VYUEVSSUVOQ0UoZ3VpbGQuZG9jdW1lbnQuZ2FtaWZpY2F0aW9uLm11bHRpcGxpZXIpKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIG1lbWJlci5kb2N1bWVudC5leHBlcmllbmNlICs9IDE7XG4gICAgICAgICAgICBjb25zdCBjb21wdXRlZExldmVsID0gZ2FtaWZpY2F0aW9uLmNvbXB1dGVMZXZlbChtZW1iZXIuZG9jdW1lbnQuZXhwZXJpZW5jZSwgZ3VpbGQuZG9jdW1lbnQuZ2FtaWZpY2F0aW9uLm11bHRpcGxpZXIpO1xuICAgICAgICAgICAgbWVtYmVyLmRvY3VtZW50LmxldmVsID0gY29tcHV0ZWRMZXZlbDtcbiAgICAgICAgICAgIGlmIChjb21wdXRlZExldmVsID4gbWVtYmVyLmRvY3VtZW50LmxldmVsKSB7XG4gICAgICAgICAgICAgICAgbWVtYmVyLmRvY3VtZW50LmJhbGFuY2UgPSBudW1iZXJzLmNsYW1wKG1lbWJlci5kb2N1bWVudC5iYWxhbmNlICsgY29tcHV0ZWRMZXZlbCAqIGdhbWlmaWNhdGlvbi5ERUZBVUxfQ1VSUkVOQ1lfUkVXQVJEX01VTFRJUExJRVIsIE51bWJlci5NQVhfU0FGRV9JTlRFR0VSKTtcbiAgICAgICAgICAgICAgICBpZiAoZ3VpbGQuZG9jdW1lbnQuZ2FtaWZpY2F0aW9uLm1lc3NhZ2VzKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UuY2hhbm5lbC5zZW5kKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYmVkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IHRlc3NlcmFjdF8xLkNvbnN0YW50cy5DT0xPUlMuSVJJUyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJMRVZFTEVEIFVQIVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGJhc3Rpb24ubG9jYWxlLmdldFN0cmluZyhndWlsZC5kb2N1bWVudC5sYW5ndWFnZSwgXCJpbmZvXCIsIFwibGV2ZWxVcFwiLCBtZXNzYWdlLmF1dGhvci50YWcsIG1lbWJlci5kb2N1bWVudC5sZXZlbCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlTGV2ZWxSb2xlcyhtZXNzYWdlLCBtZW1iZXIuZG9jdW1lbnQubGV2ZWwpXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaCh0ZXNzZXJhY3RfMS5Mb2dnZXIuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgbWVtYmVyLmRvY3VtZW50LnNhdmUoKTtcbiAgICAgICAgICAgIHJlY2VudFVzZXJzLnB1c2gobWVzc2FnZS5hdXRob3IuaWQpO1xuICAgICAgICAgICAgdGhpcy5yZWNlbnRVc2Vycy5zZXQobWVzc2FnZS5ndWlsZC5pZCwgcmVjZW50VXNlcnMpO1xuICAgICAgICAgICAgbWVzc2FnZS5jbGllbnQuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVjZW50VXNlcnMgPSB0aGlzLnJlY2VudFVzZXJzLmdldChtZXNzYWdlLmd1aWxkLmlkKTtcbiAgICAgICAgICAgICAgICByZWNlbnRVc2Vycy5zcGxpY2UocmVjZW50VXNlcnMuaW5kZXhPZihtZXNzYWdlLmF1dGhvci5pZCksIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVjZW50VXNlcnMuc2V0KG1lc3NhZ2UuZ3VpbGQuaWQsIHJlY2VudFVzZXJzKTtcbiAgICAgICAgICAgIH0sIDEzZTMpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZVRyaWdnZXJzID0gYXN5bmMgKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIGlmICghbWVzc2FnZS5jb250ZW50KVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGNvbnN0IHRyaWdnZXJzID0gYXdhaXQgVHJpZ2dlcl8xLmRlZmF1bHQuZmluZCh7IGd1aWxkOiBtZXNzYWdlLmd1aWxkLmlkIH0pO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0cmlnZ2VyIG9mIHRyaWdnZXJzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGF0dGVyblJlZ0V4cCA9IG5ldyBSZWdFeHAodHJpZ2dlci50cmlnZ2VyLnJlcGxhY2UoL1xcPy9nLCBcIi5cIikucmVwbGFjZSgvXFwqKy9nLCBcIi4qXCIpLCBcImlnXCIpO1xuICAgICAgICAgICAgICAgIGlmICghcGF0dGVyblJlZ0V4cC50ZXN0KG1lc3NhZ2UuY29udGVudCkpXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGlmICh0cmlnZ2VyLnJlc3BvbnNlTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLmNoYW5uZWwuc2VuZCh0cmlnZ2VyLnJlc3BvbnNlTWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0cmlnZ2VyLnJlc3BvbnNlUmVhY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZW1vamkgPSBlbW9qaXMucGFyc2VFbW9qaSh0cmlnZ2VyLnJlc3BvbnNlUmVhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW1vamkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UucmVhY3QoZW1vamkucmVhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmhhbmRsZVZvdGluZ0NoYW5uZWxzID0gYXN5bmMgKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZvdGluZ0NoYW5uZWwgPSBhd2FpdCBUZXh0Q2hhbm5lbF8xLmRlZmF1bHQuZmluZE9uZSh7XG4gICAgICAgICAgICAgICAgX2lkOiBtZXNzYWdlLmNoYW5uZWwuaWQsXG4gICAgICAgICAgICAgICAgdm90aW5nOiB0cnVlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoIXZvdGluZ0NoYW5uZWwpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgbWVzc2FnZS5yZWFjdChcIvCfkY1cIikuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtZXNzYWdlLnJlYWN0KFwi8J+RjlwiKS5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5leGVjID0gYXN5bmMgKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIGlmICghbWVzc2FnZS5ndWlsZClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUdhbWlmaWNhdGlvbihtZXNzYWdlKS5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlVHJpZ2dlcnMobWVzc2FnZSkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZVZvdGluZ0NoYW5uZWxzKG1lc3NhZ2UpLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnJlY2VudFVzZXJzID0gbmV3IE1hcCgpO1xuICAgIH1cbn07Il19