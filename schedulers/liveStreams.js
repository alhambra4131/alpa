const a155_0x5dc9=['language','includes','twitch','0\x20*/5\x20*\x20*\x20*\x20*','compile','channelId','toUpperCase','client','{width}','replace','send','Language','join','guilds','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','apply','TWITCH','COLORS','title','toString','720','data','catch','https://twitch.tv/','set','liveStreams','size','handleTwitchStreamers','test','then','node-fetch','twitchSubscriptions','thumbnail_url','cache','_id','{height}','streamers','has','push','readyTimestamp','exec','../models/Guild','https://api.twitch.tv/helix/streams/?user_login=','1280','find','&user_login=','application/json','channels','users','viewer_count','get','accessToken','tesseract','default','Scheduler'];(function(_0x1f78f2,_0x5dc993){const _0x20b1cf=function(_0x4ec6c8){while(--_0x4ec6c8){_0x1f78f2['push'](_0x1f78f2['shift']());}};const _0x1f7207=function(){const _0x44fcc8={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x32901f,_0x3b43a1,_0x25172f,_0x3f7388){_0x3f7388=_0x3f7388||{};let _0x3486a7=_0x3b43a1+'='+_0x25172f;let _0xa64cad=0x0;for(let _0x566595=0x0,_0x4ab1af=_0x32901f['length'];_0x566595<_0x4ab1af;_0x566595++){const _0x2864d6=_0x32901f[_0x566595];_0x3486a7+=';\x20'+_0x2864d6;const _0x30b2f0=_0x32901f[_0x2864d6];_0x32901f['push'](_0x30b2f0);_0x4ab1af=_0x32901f['length'];if(_0x30b2f0!==!![]){_0x3486a7+='='+_0x30b2f0;}}_0x3f7388['cookie']=_0x3486a7;},'removeCookie':function(){return'dev';},'getCookie':function(_0x159238,_0x4ccb31){_0x159238=_0x159238||function(_0x4c31df){return _0x4c31df;};const _0x33f822=_0x159238(new RegExp('(?:^|;\x20)'+_0x4ccb31['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x99f5dc=function(_0x3c7c12,_0x3447e7){_0x3c7c12(++_0x3447e7);};_0x99f5dc(_0x20b1cf,_0x5dc993);return _0x33f822?decodeURIComponent(_0x33f822[0x1]):undefined;}};const _0x288cbc=function(){const _0x507a99=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x507a99['test'](_0x44fcc8['removeCookie']['toString']());};_0x44fcc8['updateCookie']=_0x288cbc;let _0x5f160b='';const _0x540440=_0x44fcc8['updateCookie']();if(!_0x540440){_0x44fcc8['setCookie'](['*'],'counter',0x1);}else if(_0x540440){_0x5f160b=_0x44fcc8['getCookie'](null,'counter');}else{_0x44fcc8['removeCookie']();}};_0x1f7207();}(a155_0x5dc9,0xe8));const a155_0x20b1=function(_0x1f78f2,_0x5dc993){_0x1f78f2=_0x1f78f2-0x0;let _0x20b1cf=a155_0x5dc9[_0x1f78f2];return _0x20b1cf;};const a155_0x44fcc8=function(){let _0x3d70de=!![];return function(_0x5a1fb9,_0x428bf7){const _0x2e208d=_0x3d70de?function(){if(_0x428bf7){const _0x1abc90=_0x428bf7[a155_0x20b1('0x3')](_0x5a1fb9,arguments);_0x428bf7=null;return _0x1abc90;}}:function(){};_0x3d70de=![];return _0x2e208d;};}();const a155_0x4ec6c8=a155_0x44fcc8(this,function(){const _0xd4ec66=function(){const _0x5afcd7=_0xd4ec66['constructor']('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[a155_0x20b1('0x2f')](a155_0x20b1('0x2'));return!_0x5afcd7[a155_0x20b1('0x10')](a155_0x4ec6c8);};return _0xd4ec66();});a155_0x4ec6c8();'use strict';const tesseract_1=require(a155_0x20b1('0x28'));const node_fetch_1=require(a155_0x20b1('0x12'));const Guild_1=require(a155_0x20b1('0x1d'));const constants=require('../utils/constants');module['exports']=class LiveStreams extends tesseract_1[a155_0x20b1('0x2a')]{constructor(){super(a155_0x20b1('0xd'),{'cronTime':a155_0x20b1('0x2e')});this['handleTwitchStreamers']=async(_0x4b9edd,_0x43d1f2)=>{if(!this[a155_0x20b1('0x32')][a155_0x20b1('0x1b')])return;if(!this['twitchSubscriptions'][a155_0x20b1('0x19')](_0x4b9edd))this[a155_0x20b1('0x13')]['set'](_0x4b9edd,[]);const _0x3a0102=this[a155_0x20b1('0x13')][a155_0x20b1('0x26')](_0x4b9edd);const _0x4e1646=await node_fetch_1[a155_0x20b1('0x29')](a155_0x20b1('0x1e')+_0x43d1f2[a155_0x20b1('0x24')][a155_0x20b1('0x0')](a155_0x20b1('0x21')),{'headers':{'Accept':a155_0x20b1('0x22'),'Authorization':'Bearer\x20'+this[a155_0x20b1('0x32')]['credentials']['twitch'][a155_0x20b1('0x27')],'Client-ID':this['client']['credentials'][a155_0x20b1('0x2d')]['clientId']}});const _0x47dd90=(await _0x4e1646['json']())[a155_0x20b1('0x9')];for(const _0x256629 of _0x47dd90){if(_0x3a0102[a155_0x20b1('0x2c')](_0x256629['id']))continue;if(this['client']['channels'][a155_0x20b1('0x15')][a155_0x20b1('0x19')](_0x43d1f2['channelId'])){await this[a155_0x20b1('0x32')][a155_0x20b1('0x23')][a155_0x20b1('0x15')][a155_0x20b1('0x26')](_0x43d1f2['channelId'])[a155_0x20b1('0x35')]({'embed':{'color':constants[a155_0x20b1('0x5')][a155_0x20b1('0x4')],'author':{'name':_0x256629['user_name'],'url':a155_0x20b1('0xb')+_0x256629['user_name']},'description':_0x256629[a155_0x20b1('0x6')],'fields':[{'name':'Viewers','value':_0x256629[a155_0x20b1('0x25')][a155_0x20b1('0x7')](),'inline':!![]},{'name':a155_0x20b1('0x36'),'value':_0x256629[a155_0x20b1('0x2b')][a155_0x20b1('0x31')](),'inline':!![]}],'image':{'url':_0x256629[a155_0x20b1('0x14')][a155_0x20b1('0x34')](a155_0x20b1('0x33'),a155_0x20b1('0x1f'))['replace'](a155_0x20b1('0x17'),a155_0x20b1('0x8'))},'footer':{'text':'ðŸ”´\x20LIVE'},'timestamp':_0x256629['started_at']}})[a155_0x20b1('0x11')](()=>{_0x3a0102[a155_0x20b1('0x1a')](_0x256629['id']);})[a155_0x20b1('0xa')](()=>{});}}this[a155_0x20b1('0x13')][a155_0x20b1('0xc')](_0x4b9edd,_0x3a0102);};this[a155_0x20b1('0x1c')]=async()=>{if(!this['client']['guilds'][a155_0x20b1('0x15')][a155_0x20b1('0xe')])return;const _0x380fe2=await Guild_1[a155_0x20b1('0x29')][a155_0x20b1('0x20')]({'$or':this[a155_0x20b1('0x32')][a155_0x20b1('0x1')][a155_0x20b1('0x15')]['map'](_0x1de6b1=>({'_id':_0x1de6b1['id']})),'streamers':{'$exists':!![]}});for(const _0x1299f1 of _0x380fe2){if(_0x1299f1[a155_0x20b1('0x18')][a155_0x20b1('0x2d')]&&_0x1299f1['streamers']['twitch'][a155_0x20b1('0x30')]&&_0x1299f1[a155_0x20b1('0x18')]['twitch']['users']['length']){this[a155_0x20b1('0xf')](_0x1299f1[a155_0x20b1('0x16')],_0x1299f1[a155_0x20b1('0x18')][a155_0x20b1('0x2d')]);}}};this[a155_0x20b1('0x13')]=new Map();}};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpdmVTdHJlYW1zLmpzIl0sIm5hbWVzIjpbInRlc3NlcmFjdF8xIiwicmVxdWlyZSIsIm5vZGVfZmV0Y2hfMSIsIkd1aWxkXzEiLCJjb25zdGFudHMiLCJtb2R1bGUiLCJMaXZlU3RyZWFtcyIsImNvbnN0cnVjdG9yIiwiXzB4NGI5ZWRkIiwiXzB4NDNkMWYyIiwiXzB4M2EwMTAyIiwiXzB4NGUxNjQ2IiwiXzB4NDdkZDkwIiwiXzB4MjU2NjI5IiwiXzB4MzgwZmUyIiwiXzB4MWRlNmIxIiwiXzB4MTI5OWYxIiwiTWFwIl0sIm1hcHBpbmdzIjoiMDhGQUFBLGFBS0EsTUFBTUEsV0FBQSxDQUFjQyxPQUFBLEMsbUJBQUEsQ0FBcEIsQ0FDQSxNQUFNQyxZQUFBLENBQWVELE9BQUEsQyxtQkFBQSxDQUFyQixDQUNBLE1BQU1FLE9BQUEsQ0FBVUYsT0FBQSxDLG1CQUFBLENBQWhCLENBQ0EsTUFBTUcsU0FBQSxDQUFZSCxPQUFBLEMsb0JBQUEsQ0FBbEIsQ0FDQUksTUFBQSxDLFNBQUEsRUFBaUIsTUFBTUMsV0FBTixTQUEwQk4sV0FBQSxDLG1CQUFBLENBQXNCLENBQzdETyxXQUFBLEVBQWMsQ0FDVixNLGtCQUFBLENBQXFCLEMsVUFDakIsQyxtQkFEaUIsQ0FBckIsRUFHQSxLLHVCQUFBLEVBQTZCLE1BQU9DLFNBQVAsQ0FBZ0JDLFNBQWhCLEdBQXlCLENBQ2xELEdBQUksQ0FBQyxLLG1CQUFBLEUsbUJBQUEsQ0FBTCxDQUNJLE9BQ0osR0FBSSxDQUFDLEsscUJBQUEsRSxtQkFBQSxFQUE2QkQsU0FBN0IsQ0FBTCxDQUNJLEssbUJBQUEsRSxLQUFBLEVBQTZCQSxTQUE3QixDQUFzQyxFQUF0QyxFQUNKLE1BQU1FLFNBQUEsQ0FBa0IsSyxtQkFBQSxFLG1CQUFBLEVBQTZCRixTQUE3QixDQUF4QixDQUNBLE1BQU1HLFNBQUEsQ0FBVyxNQUFNVCxZQUFBLEMsbUJBQUEsRSxtQkFBcUIsQ0FBcURPLFNBQUEsQyxtQkFBQSxFLGtCQUFBLEUsbUJBQUEsQ0FBMUUs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XG4vKiFcbiAqIEBhdXRob3IgU2Fua2Fyc2FuIEthbXBhIChrM3JuMzFwNG5pYylcbiAqIEBjb3B5cmlnaHQgMjAyMCAtIFRoZSBCYXN0aW9uIEJvdCBQcm9qZWN0XG4gKi9cbmNvbnN0IHRlc3NlcmFjdF8xID0gcmVxdWlyZShcInRlc3NlcmFjdFwiKTtcbmNvbnN0IG5vZGVfZmV0Y2hfMSA9IHJlcXVpcmUoXCJub2RlLWZldGNoXCIpO1xuY29uc3QgR3VpbGRfMSA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvR3VpbGRcIik7XG5jb25zdCBjb25zdGFudHMgPSByZXF1aXJlKFwiLi4vdXRpbHMvY29uc3RhbnRzXCIpO1xubW9kdWxlLmV4cG9ydHMgPSBjbGFzcyBMaXZlU3RyZWFtcyBleHRlbmRzIHRlc3NlcmFjdF8xLlNjaGVkdWxlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwibGl2ZVN0cmVhbXNcIiwge1xuICAgICAgICAgICAgY3JvblRpbWU6IFwiMCAqLzUgKiAqICogKlwiLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5oYW5kbGVUd2l0Y2hTdHJlYW1lcnMgPSBhc3luYyAoZ3VpbGRJZCwgaW5mbykgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNsaWVudC5yZWFkeVRpbWVzdGFtcClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBpZiAoIXRoaXMudHdpdGNoU3Vic2NyaXB0aW9ucy5oYXMoZ3VpbGRJZCkpXG4gICAgICAgICAgICAgICAgdGhpcy50d2l0Y2hTdWJzY3JpcHRpb25zLnNldChndWlsZElkLCBbXSk7XG4gICAgICAgICAgICBjb25zdCBub3RpZmllZFN0cmVhbXMgPSB0aGlzLnR3aXRjaFN1YnNjcmlwdGlvbnMuZ2V0KGd1aWxkSWQpO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBub2RlX2ZldGNoXzEuZGVmYXVsdChcImh0dHBzOi8vYXBpLnR3aXRjaC50di9oZWxpeC9zdHJlYW1zLz91c2VyX2xvZ2luPVwiICsgaW5mby51c2Vycy5qb2luKFwiJnVzZXJfbG9naW49XCIpLCB7XG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiICsgdGhpcy5jbGllbnQuY3JlZGVudGlhbHMudHdpdGNoLmFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICAgICAgICBcIkNsaWVudC1JRFwiOiB0aGlzLmNsaWVudC5jcmVkZW50aWFscy50d2l0Y2guY2xpZW50SWQsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgc3RyZWFtcyA9IChhd2FpdCByZXNwb25zZS5qc29uKCkpLmRhdGE7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHN0cmVhbSBvZiBzdHJlYW1zKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWVkU3RyZWFtcy5pbmNsdWRlcyhzdHJlYW0uaWQpKVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jbGllbnQuY2hhbm5lbHMuY2FjaGUuaGFzKGluZm8uY2hhbm5lbElkKSkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNsaWVudC5jaGFubmVscy5jYWNoZS5nZXQoaW5mby5jaGFubmVsSWQpLnNlbmQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZW1iZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogY29uc3RhbnRzLkNPTE9SUy5UV0lUQ0gsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHN0cmVhbS51c2VyX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCJodHRwczovL3R3aXRjaC50di9cIiArIHN0cmVhbS51c2VyX25hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogc3RyZWFtLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIlZpZXdlcnNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzdHJlYW0udmlld2VyX2NvdW50LnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmxpbmU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiTGFuZ3VhZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzdHJlYW0ubGFuZ3VhZ2UudG9VcHBlckNhc2UoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlubGluZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogc3RyZWFtLnRodW1ibmFpbF91cmwucmVwbGFjZShcInt3aWR0aH1cIiwgXCIxMjgwXCIpLnJlcGxhY2UoXCJ7aGVpZ2h0fVwiLCBcIjcyMFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3Rlcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIvCflLQgTElWRVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBzdHJlYW0uc3RhcnRlZF9hdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpZWRTdHJlYW1zLnB1c2goc3RyZWFtLmlkKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnR3aXRjaFN1YnNjcmlwdGlvbnMuc2V0KGd1aWxkSWQsIG5vdGlmaWVkU3RyZWFtcyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZXhlYyA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5jbGllbnQuZ3VpbGRzLmNhY2hlLnNpemUpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgZ3VpbGREb2N1bWVudHMgPSBhd2FpdCBHdWlsZF8xLmRlZmF1bHQuZmluZCh7XG4gICAgICAgICAgICAgICAgJG9yOiB0aGlzLmNsaWVudC5ndWlsZHMuY2FjaGUubWFwKGcgPT4gKHsgX2lkOiBnLmlkIH0pKSxcbiAgICAgICAgICAgICAgICBzdHJlYW1lcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJGV4aXN0czogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGd1aWxkIG9mIGd1aWxkRG9jdW1lbnRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGd1aWxkLnN0cmVhbWVycy50d2l0Y2ggJiYgZ3VpbGQuc3RyZWFtZXJzLnR3aXRjaC5jaGFubmVsSWQgJiYgZ3VpbGQuc3RyZWFtZXJzLnR3aXRjaC51c2Vycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVUd2l0Y2hTdHJlYW1lcnMoZ3VpbGQuX2lkLCBndWlsZC5zdHJlYW1lcnMudHdpdGNoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudHdpdGNoU3Vic2NyaXB0aW9ucyA9IG5ldyBNYXAoKTtcbiAgICB9XG59OyJdfQ==